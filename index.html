<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Elections</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/intersection-observer@0.5.1/intersection-observer.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/scrollama/3.2.0/scrollama.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.3.0/d3.min.js"></script>

    <link rel="stylesheet" href="css/scrolly-styles.css">
    <!-- <link rel="stylesheet" href="css/reset.css"> -->

<style>
  .body {
        text-rendering: optimizeLegibility;
        font-size: 20px;
    }
    .header {
        height: 100vh;
        width: 100%;
        padding: 0;
    }

    .with-image-bg,
    .with-video-bg {
            position: relative;
            background-size: cover;
            background-position: center;
        }

    .with-image-bg {
            background-image: url("assets/cover.png");
    }

    .video-background {
            position: absolute;
            top: 0;
            width: 100%;
            height: 100%; 
        }

    .video-background video {
            object-fit: cover;
            width: 100%;
            height: 100%;
        }

    .header-text {
        /* background-color: lightcoral; */
        width: 40%;
        margin: 0 auto;
        position: relative;
        top: 60%;
        font-size: 20px;
    }

    .header h1 {
        font-family: 'Playfair Display', serif;
        font-size: 3em;
        padding-bottom: 10px;
        text-align: center;
        color: white;
        text-shadow: 1px 1px 2px black;
    }

    .header h3 {
        font-family: 'Playfair Display', serif;
        font-size: 1em;
        text-align: center;
        padding-bottom: 10px;
        color: white;
        text-shadow: 1px 1px 2px black;
        line-height: 1.3em;
    }

    .header .byline {
        /* background-color: beige; */
        padding: 10px;
        line-height: 1em;
       
    }

    .header .byline p {
        font-family: 'Open Sans', sans-serif;
        font-size: 0.8em;
        color: white;
        text-shadow: 1px 1px 2px black;
        

    }

    .content {
        width: 630px;
        margin: 0 auto;
        padding-top: 20px;
        padding-bottom: 20px;
        position: relative;
    }

    .content p {
        margin-bottom: 20px;
        line-height: 1.3em;
        font-size: 20px;
    }

    /* figure */
    .figure {
    background-color: lightgrey;
    width: 600px;
    margin: 0 auto;
    position: relative;
    }

    .figure video {
        width: 100%;
        display: block;
    }

    .figure .image-container {
    width: 100%;
    background-color: white;
    }

    .figure img {
        width: 100%;
        height: auto;
        display: block;
    }

    .figure figcaption {
        padding: 10px;
    }

    .figure p {
        font-family: 'Open Sans', sans-serif;
        font-size: 0.75em;
        margin: 0 0 5px 0;
        opacity: 0.8;
    }

    .figure span {
        font-size: 1em;
        font-family: 'Open Sans', sans-serif;
        display: block;
    }

    /* play videos */
    .video-container {
    position: relative;
    width: 100%;
    }

    .custom-video {
    width: 100%;
    display: block;
}
    .play-button {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        border: none;
        border-radius: 50%;
        font-size: 24px;
        padding: 20px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .play-button:hover {
        background-color: rgba(0, 0, 0, 0.9);
    }

    /* blockquote */
    .quote {
    max-width: 600px;
    margin: 20px auto;
    background-color: #f9f9f9;
    border-left: 5px solid #ccc;
    padding: 15px 20px;
    }

    .quote blockquote {
        margin: 0;
    }

    .quote p {
        margin: 10px 0;
        line-height: 1.4;
    }

    .quote figcaption {
        margin-top: 10px;
        font-style: italic;
        color: #666;
    }

    .footer {
        background-color: lightblue;
        height: 100px;
        text-align: center;
    }

    .footer p {
        font-family: 'Open Sans', sans-serif;
        font-size: 0.8em;
        padding-top: 50px;
    }  
</style>
</head>

<body>

<!-- scrolly harris-videos -->

    <section id="scrolly-videos" class="scrolly-container">
        <div class="sticky-thing">
          <video src="assets/harris-videos/harris-1.mp4" alt="Cover image" loop muted>
            <source src="" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        <div class="steps-container">
          <div class="step" id="step1">
            <div>
              <p>It only took hours after U.S. President Joe Biden ended his bid for re-election before fake videos mocking his successor, Kamala Harris, started racing through social media.</p>
            </div>
          </div>
          <div class="step" id="step2">
            <p>In one example on TikTok, artificial intelligence was used to mimic the voice of Harris to make it sound like she was rambled incoherently about how "today was today and yesterday was today."</p>
          </div>
          <div class="step" id="step3">
            <p>More altered videos of Harris started showing up with the hashtag #wordsaladswithkamala.</p>
          </div>
          <div class="step" id="step4">
            <p>Harris, the target of the videos, was new but it shows how AI-generated content is being used to influence voters.</p>
          </div>
        </div>
    </section>

<!-- title graphic -->
<div class="header">
    <div class="header with-image-bg">
        <div class="header-text">
            <h1>Election Deepfakes</h1>
            <h3>AI-Generated Elections Content Slipping Through the Cracks of TikTok’s Labeling Initiative</h3>
                <div class="byline">
                    <p>By Katrina Ventura</p>
                    <p>August 14, 2024</p>
                </div>
        </div>
    </div>
</div>

    <div class="content">
        <p>Presidents Joe Biden and Donald Trump have been the subject of many AI-generated TikTok viral moments which could easily shift from harmless tomfoolery to outright election threats.</p>

        <p>Unlike in previous elections, the growing scope of misinformation stands out in 2024 as never before, as millions of social media users have the opportunity to pass convincing and fake content around the digital world at the click of a mouse. 
            
        <p>The extent of how much AI-generated content is being spread on social media platforms like TikTok, changes day to day in the ever-morphing world of social media but a snapshot of the multiple types of AI-generated election TikToks emerged in an analysis by Columbia University Graduate School of Journalism of over 500 TikToks with the hashtags #AIBiden or #AITrump.</p>

    </div>
    
<!-- bubble.js -->
<section id="scrolly-bubbles">
    <div class="sticky-thing">
        <div id="graphic"></div>
    </div>
    <div class="steps-container">
        <!-- <div class ="step" data-step="0" id="step1">
            <p>Over 500 TikToks had the hashtags #AIBiden or #AITrump.</p>
        </div> -->
        <div class="step" data-step="1">
            <p>36% of the AI-generated content were memes of Biden and Trump playing video games.</p>
        </div>
        <div class="step" data-step="2">
            <p>39% of the AI-generated content were deepfakes.</p>
        </div>
        <div class="step" data-step="3">
            <p>While 20% were AI voices of Biden and Trump singing random songs, including ones in Vietnamese.</p>
        </div>
        <div class="step" data-step="4" id="step4">
            <p>The remaining TikToks featured content creators or random videos using #AIBiden or #AITrump.</p>
        </div>
    </div>
</section>

    <div class="content">
        
        <p>Election fakery is not new but the volume and reach that AI-generated content can get on social media is unprecedented. </p>

        <p>For the first time ever, everyone on the internet has access to artificial intelligence tools that can create fake videos, images, and audio which can be pushed out to millions of viewers online.</p>
            
        <p>Calls to regulate the use of artificial intelligence on social media have strengthened in <a href="https://rollcall.com/2024/06/04/congress-wrestles-with-ais-boost-to-campaigns-potential-misuse/">Congress</a> after videos of Harris speaking incoherently went viral on TikTok. While federal regulators continue their crackdown on deepfake technology impersonating politicians after a <a href="https://apnews.com/article/biden-robocalls-ai-new-hampshire-charges-fines-9e9cc63a71eb9c78b9bb0d1ec2aa6e9c">robocall</a> of Biden told democrats not to participate in the primary election in New Hampshire.</p>
        
        <p>But Judy Muller, a retired professor from the USC Annenberg School of Journalism, says efforts to contain generative AI content might be too late.</p>
        
        <p>“It is really a whole new ball game.” said Muller. "It's one thing in the old days to have those old chants, mudslinging and political campaigns because it wasn't everywhere all at once. But that is what's happening — AI is everywhere all at once and it is powerful."</p>

        <p>And it is not just artificial intelligence tools alone that is driving the change in the way misinformation is spread. The rise of social media platforms like TikTok, which has been the subject of Congressional hearings and is under pressure to divest itself from its Chinese parent company ByteDance, have made it easier for anyone to post AI-generated content about the 2024 elections.</p>

        <p>In one <a href='https://www.tiktok.com/@mrsfozz/video/7373385814803336481?lang=en'>deepfake TikTok of Biden</a> posted by the account Mrs. Fozz, the President addresses the nation from inside the oval office and admits to being the mastermind behind Trump’s “hush money” criminal trial. While the video does show signs of digitally manipulated content — as Biden’s face appears blurry and the voice is not in sync, it is not until Biden says “Psych! Who the f*ck am I kidding folks,” that viewers can be sure that it is not real.
        </p>

        <p>“I think the horse has left the barn,” said Muller. “These are some of the most primitive fakes that I've seen and honestly they're better already.”</p>

    </div>

        <figure class="figure">
            <div class="video-container">
                <video class="custom-video" src="assets/samples/biden-psa.mp4"></video>
                <button class="play-button">▶</button>
            </div>
            <figcaption>
                <p><a href="https://www.tiktok.com/@mrsfozz/video/7373385814803336481">TikTok uploaded by @mrsfozz</a></p>
                <span>A deepfake video of Biden telling the public that he had Trump arrested and taken to a secret prison.</span>
            </figcaption>
        </figure>
    
    <div class="content">

        <p>Maurice Turner, a public interest technologist and cybersecurity expert on TikTok’s Global Public Policy Team, said over 98% of election related deceptive content is taken down by the system even before it gets flagged.</p>

        <p>“We do things like have machine-based processes as well as human-based processes for detecting and being able to evaluate content that we suspect might be deceptive,” said Turner.</p>

        <p>TikTok took down deepfake videos of Harris sounding incoherent soon after it went viral on the platform. But more deepfakes of Harris continued to show up in X, and TikTok. One of them was a <a href="https://apnews.com/article/parody-ad-ai-harris-musk-x-misleading-3a5df582f911a808d34f68b766aa3b8e">parody ad</a> reposted by X owner Elon Musk of Harris calling herself the “ultimate diversity hire” which reached 130 million views.</p>

        <p>Despite TikTok's efforts to properly label AI-generated content, only 12% of the TikToks in the analysis had the "Made with AI" label.<p> 

    </div>

    <!-- insert graph of AI labels -->
    <!-- <figure class="figure">
        <div class="video-container">
            <video class="custom-video" src="assets/samples/harris-diversity.mp4"></video>
            <button class="play-button">▶</button>
        </div>
        <figcaption>
            <p><a href="https://www.tiktok.com/@elonmusk/video/7373385814803336481">TikTok uploaded by @elonmusk</a></p>
            <span>A deepfake video of Harris calling herself the "ultimate diversity hire."</span>
        </figcaption> -->


    <div class="content">
        <h2>AI Elections Deepfakes</h2>

        <p>Beatriz Saab, a digital democracy researcher at Democracy Reporting International, released a <a href="https://www.ned.org/manufacturing-deceit-how-generative-ai-supercharges-information-manipulation/">report</a> on the ways in which generative AI has been used by authoritarians to manufacture deceit. Saab says generative AI has been used to create deepfakes of around events that are taking place in order to reinforce certain beliefs or fears.</p>

        <p>“So they try to get a real incident and they manipulate the reality by adding elements or false images around something that really existed,” said Saab.</p>

        <p>Deepfake images of Trump as a prisoner have been circulating on social media. The images show Trump in an orange jumpsuit, looking like an inmate and posing for fake mugshots.</p>

        <p>But like many AI-generated content on TikTok, the fake image of Trump has been imbued with humor.</p>
    </div>
    
    <figure class="figure">
        <div class="video-container">
            <video class="custom-video" src="assets/samples/trump-rapping.mp4"></video>
            <button class="play-button">▶</button>
        </div>
        <figcaption>
            <p><a href="https://www.tiktok.com/@st0l3nm3memes/video/7271671808980536618">TikTok uploaded by @st0l3nm3memes</a></p>
            <span>A deepfake audio of Trump rapping about his time in prison.</span>
        </figcaption>
    </figure>

    <div class="content">
        <p>TikTok as an entertainment platform has been known for creating dance challenges and making viral sounds. By packaging the TikToks as parodies, the AI-generated content has been able to bypass the platform’s guidelines on misleading content.</p>
        
        <p> Saab said some studies have shown how satire has been used to seed harmful ideas such as online gender-based violence.</p>
    
        <p>“We do see that there are some studies that show how malicious actors used humor as a way to get past the platform guidelines,” said Saab. </p>

        <p>Generative AI tools have also been used to create fake presidential debates between Biden and Trump. The account @aitrumporbiden has been uploading clips of the two presidents debating as early as July 2023, before any nomination was made. The channel pokes fun at the two presidents and involves Biden and Trump trash talking one another. At times the videos are made to show Biden talking incoherently, and Trump talking about World of Warcraft.</p>
    </div>

    <figure class="figure">
        <div class="video-container">
            <video class="custom-video" src="assets/samples/debate.mp4"></video>
            <button class="play-button">▶</button>
        </div>
        <figcaption>
            <p><a href="https://www.tiktok.com/@aitrumporbiden/video/7257204951854730538">TikTok uploaded by @aitrumporbiden</a></p>
            <span>A parody debate between Biden and Trump.</span>
        </figcaption>
    </figure>


    <div class="content">

        <p>Some TikTok accounts use generative AI to garner support around the two presidents The TikTok account @talkthenews features AI-generated content of Biden as a character called 'Papa Joe.' With 71 followers, the account's videos average 200 views each. The AI-generated videos typically depict Biden seated by a fireplace, wearing a suit, and consistently smiling.</p>

        <p>Another TikTok account @trumposaurusrex was created to upload AI-generated images of Trump as heroes and main characters in movies. The account has more than a thousand followers and 2000 likes. Trump is depicted as Aquaman, Green Lantern, Batman, or as a gladiator, Men in Black, Jedi in Star Wars.</p>

    </div>

    <div class="content">
     <h2>Gamer Memes</h2>

        <p>Another popular use of generative AI on TikTok is to create gamer memes of the two presidents. Videos of the presidents as gamers started showing up in February 2023, when the account @presidentialdeepfakes posted a video of Biden and Trump hanging out at the amusement park. The video was viewed over 8 million times and other TikTokers started copying the format.</p>
     
        <p>The TikTok videos typically follow a consistent format: a split-screen presentation where the top half displays edited images of Presidents Joe Biden, Donald Trump, and Barack Obama wearing gaming headsets and the bottom half shows footage from an actual video game.</p>

        <p>The AI parodies tend to be humorous as users would comment about how they find the videos entertaining. The parodies are neither pro-Biden or pro-Trump and equally mocks or highlights the negative stereotypes of each character.</p>

        <p>Biden is almost always depicted as a timid, slow character who is often the coward in these scenarios. He is called sleepy joe by his peers and would get mocked at “messing things up” or being weird. While Trump is often depicted as the reckless, arrogant character bullying Biden but also gets trash talked by his peers and mocked for being a felon. Another interesting character is former President Barack Obama who often comes in defense of Biden and is often the voice of reason in these scenarios.</p> 
    </div>

        <figure class="figure">
            <div class="video-container">
                <video class="custom-video" src="assets/samples/presidentialdeepfakes.mp4"></video>
                <button class="play-button">▶</button>
            </div>
            <figcaption>
                <p><a href="https://www.tiktok.com/@presidentialdeepfakes/video/7202988788056984878">TikTok uploaded by @presidentialdeepfakes</a></p>
                <span>A parody video of presidents Biden, Obama, and Trump playing Minecraft.</span>
            </figcaption>
        </figure>
    
    <div class="content">

        <p>Jessica Maddox, an assistant professor of digital media at the University of Alabama who has done research into the creator economy on TikTok says the videos were created to be entertaining to reach a wider audience, which is a similar strategy used by content farms.</p>

        <p>Content farming refers to the practice of producing large quantities of low-quality content with the primary aim of generating revenue through online advertising. Basic AI tools now make it easier for users to create and publish videos rapidly to temporarily boost views and likes on the page.</p>

        <p>A <a href="https://www.404media.co/inside-the-world-of-tiktok-spammers-and-the-ai-tools-that-enable-them/">report</a> by 404 Media highlights a user offering a masterclass on using AI tools to generate spam content, claiming to have earned thousands of dollars from the platform. The videos featured in the masterclass combine clips from video games with trivia narrated by an AI-generated voice, similar to the videos of the presidents playing video games.</p>

        <p>“Anybody could kind of get what they want out of that video whether you're a conservative or liberal,” said Maddox. “There's so much lack of context that it could be humor, it could be serious. Somebody could hide behind just kidding.”</p>

        <p>Content recycling is evident across multiple creators. One particular video of the presidents playing video games has been repurposed with different storylines. Notably, the same AI-generated image of Biden wearing headsets appears in various videos by different users, suggesting widespread reuse of certain AI-generated assets.</p>

    </div>

    <!-- create a figure of 4 images repeating -->

    <div class="content">
        <p>However, TikTok is a notoriously low-paying platform for creators which is why Maddox suggests the motivation for spamming humorous, and non-partisan AI-generated videos on TikTok might be for the purpose of engagement.</p>

        <p>“Essentially, the same YouTube short makes thousands of dollars on YouTube but they may make $40 on TikTok,” said Maddox. "So it's really interesting to me that we are seeing this kind of AI content farming, engagement bait on TikTok, when TikTok isn't typically a high-paying platform.”</p>

        <p>TikTok’s <a href="https://www.tiktok.com/legal/page/global/tiktok-creativity-program-beta-terms-eea/en">Creativity Program Beta</a> requires accounts to have at least 10,000 authentic followers on the platform, and 100,000 authentic video views in order to qualify for the rewards feature. Only a fifth of the TikTok videos in the random sample have enough followers to satisfy the first requirement.</p>

        <p>Among them are TikTok accounts such as Gcabin and Lilnubbycake that have jumped in the bandwagon of AI President videos. The TikTok account @gcabin which has 1.5 million followers and 29.2 million likes and describes itself as a "daily dose of internet highlights", uploaded a gamer meme of Biden discussing music while playing over Minecraft footage. Meanwhile, @lilnubbycake which has 670.3K followers and 38.5M likes and was originally created for video game content, also started uploading AI-generated videos of Biden and Trump playing video games which averages 4000 views.</p> 

        <p>While these AI-generated videos often place presidential candidates in absurd contexts or use language atypical for political figures, Maddox says there is a danger in how well the audio mimics Biden and Trump’s voices.</p>

        <p>“They can make these silly, seemingly harmless videos as practice and then hone their AI manipulated media skills for something that could go viral in a context that isn't so clearly a joke,” said Maddox.</p>

    </div>

    <div class="content">
        <h2>Song Covers</h2>

        <p>TikTok is also being flooded with AI-generated audio of Trump or Biden doing covers of popular songs. One particular genre that showed up in hashtag AI Trump videos were videos of Trump singing Vietnamese songs. The audio was generated using AI and synced to Vietnamese traditional songs as well as pop. 
        </p>

        <p>Long Bui, a Professor of Global and International Studies at the University of California, Irvine translated the Vietnamese songs on TikTok and found that the songs had some ambiguous lyrics that could be interpreted as either mocking or sympathizing with Trump.</p>

        <p>"They're making fun of him, but they also support him," said Bui. “So it allows the message to come across without being too overly serious, but then gets more audience and reactions.”</p>

        <p>Vietnamese are the most Republican-leaning Asian American group, and many have supported Trump in the 2020 elections. Bui explains that Vietnamese-Americans, especially the older generation, tend to favor Trump and the Republicans due to foreign policy issues, particularly regarding China's actions in the Spratly Islands.</p>

        <p>Some of the AI-generated covers use Vietnamese nursery rhymes like Con cò bé bé (A Little Baby Stork), which mothers sing to help their babies fall asleep. Other videos depict Trump as pining over a lover by using the song "Gió" by the emo/indie punk band from Philadelphia, Jank.</p>

    </div>

    <figure class="figure">
            <div class="video-container">
                <video class="custom-video" src="assets/samples/hungnehi.mp4"></video>
                <button class="play-button">▶</button>
            </div>
            <figcaption>
                <p><a href="https://www.tiktok.com/@hungne_hi/video/7238214412320918790">TikTok uploaded by @hungne_hi</a></p>
                <span>An AI generated voice of Trump singing a Vietnamese nursery rhyme.</span>
            </figcaption>
        </figure>
 
    <div class="content">
        <p>Bui suggests that the songs were likely created by Vietnamese individuals rather than the Trump campaign due to their distinct brand of humor. He adds that the videos convey Trump's campaign message in a lighthearted manner.</p>

        <p>“I think people enjoy the videos because it's not serious,” said Bui. “It allows the message to come across and get more audience, reaction, and fans.”</p>

    </div>

    <div class="content">
        <h2>TikToker's Reaction</h2>

        <p>TikTok users commenting on the AI-generated TikToks of the presidents say they have expressed that they understand that these videos play with the humor of TikTok. While they are not meant to be taken seriously Muller believes that there is cause for concern.
        </p>

         <!-- create a figure of 4 images repeating -->
         
        <p>“I do think you should stop worrying about the people who do it, and worry about the people who consume it,” said Muller. “We have to have the Clean Air waves and the clean media in the sense that it can't be infiltrated by fake AI and bots and they're just going to have to be some controls.”
        </p>

    </div>
    

    <div class="footer">
        <p>Footer</p>
    </div>

<!-- scripts -->

<script>

document.addEventListener('DOMContentLoaded', function() {
    const videoContainers = document.querySelectorAll('.video-container');

    videoContainers.forEach(container => {
        const video = container.querySelector('.custom-video');
        const playButton = container.querySelector('.play-button');

        playButton.addEventListener('click', function() {
            if (video.paused) {
                video.play();
                playButton.textContent = '❚❚'; // Change to pause symbol
            } else {
                video.pause();
                playButton.textContent = '▶'; // Change back to play symbol
            }
        });

        video.addEventListener('play', function() {
            playButton.style.opacity = '0';
        });

        video.addEventListener('pause', function() {
            playButton.style.opacity = '1';
            playButton.textContent = '▶';
        });

        video.addEventListener('ended', function() {
            playButton.style.opacity = '1';
            playButton.textContent = '▶';
        });
    });
});

//     // Play and pause video
//     document.addEventListener('DOMContentLoaded', function() {
//     const video = document.getElementById('myVideo');
//     const playButton = document.getElementById('playButton');

//     playButton.addEventListener('click', function() {
//         if (video.paused) {
//             video.play();
//             playButton.textContent = '❚❚'; // Change to pause symbol
//         } else {
//             video.pause();
//             playButton.textContent = '▶'; // Change back to play symbol
//         }
//     });

//     video.addEventListener('play', function() {
//         playButton.style.opacity = '0';
//     });

//     video.addEventListener('pause', function() {
//         playButton.style.opacity = '1';
//         playButton.textContent = '▶';
//     });
// });
</script>


<script>
    /* // video scrolly */
    (() => {
    const scroller = scrollama()
    let currentAudio = null;
    
    scroller
    .setup({
    parent: document.querySelector("#scrolly-videos"),
    step: ".step",
    offset: 0.8,
    debug: false,
    })
    .onStepEnter(function ({ element, index, direction }) {
    const event = new CustomEvent("stepin", { detail: { direction: direction } })
    element.dispatchEvent(event)
    
    // Play the video when entering the step
    const video = element.querySelector('video')
    if (video) {
        video.play()
    }
    })
    .onStepExit(function ({ element, index, direction }) {
    const event = new CustomEvent("stepout", { detail: { direction: direction } })
    element.dispatchEvent(event)
    
    // Pause the video when exiting the step
    const video = element.querySelector('video')
    if (video) {
        video.pause()
    }

    // Stop audio if it's playing
    if (currentAudio) {
            currentAudio.pause()
            currentAudio.currentTime = 0
            currentAudio = null
        }
    
    if (direction === "up" && element.previousElementSibling) {
        const prevEvent = new CustomEvent("stepin", { detail: { direction: direction } })
        element.previousElementSibling.dispatchEvent(prevEvent)
        
        // Play the video of the previous step when scrolling up
        const prevVideo = element.previousElementSibling.querySelector('video')
        if (prevVideo) {
        prevVideo.play()
        }
    }
    })
    
    window.addEventListener("resize", scroller.resize)
    })()
    
    d3.select("#step1").on('stepin', (e) => {
      const container = d3.select(e.target.closest(".scrolly-container"));
      container.select("img").attr("src", "assets/harris-videos/harris-1.mp4").style("display", "block");
      container.select("video").style("display", "none");
    })

    d3.select("#step2").on('stepin', (e) => {
        const container = d3.select(e.target.closest(".scrolly-container"));
        container.select("img").style("display", "none");
        const video = container.select("video")
            .attr("src", "assets/harris-videos/harris-1.mp4")
            .style("display", "block");
        video.node().play();

        // Add and play audio
        let audio = container.select("audio");
        if (audio.empty()) {
            audio = container.append("audio").attr("src", "assets/harris-videos/harris.mp3");
        } else {
            audio.attr("src", "assets/harris.mp3");
        }
        currentAudio = audio.node();
        currentAudio.play().catch(e => console.error("Error playing audio:", e));
    })
    
    d3.select("#step3").on('stepin', (e) => {
      const container = d3.select(e.target.closest(".scrolly-container"));
      container.select("img").style("display", "none");
      const video = container.select("video")
        .attr("src", "assets/harris-videos/harris-2.mp4")
        .style("display", "block");
      video.node().play();
    })
    
    d3.select("#step4").on('stepin', (e) => {
      const container = d3.select(e.target.closest(".scrolly-container"));
    })

</script>


<script>
    // Load the dataset
    d3.csv('data-viz.csv').then(loadData);
    
    // Define the width and height of the SVG
    var width = 900;
    var height = 900;
    
    // Define the size of the rectangles
    var rectWidth = 27;
    var rectHeight = 48;
    
    // Create the force simulation
    var simulation = d3.forceSimulation();
    
    // Create the SVG
    var svg = d3.select('#graphic')
                .append('svg')
                .attr('width', width)
                .attr('height', height)
                .append('g');
    console.log("SVG created:", svg.node());
    
    // Load the data
    function loadData(data) {
        console.log(data);
    
        // Create the defs for patterns
        var defs = svg.append('defs');
    
        function updatePatterns(filteredData) {
            defs.selectAll(".video-image")
                .data(filteredData, d => d.id)
                .join(
                    enter => enter.append("pattern")
                        .attr("class", "video-image")
                        .attr('id', d => d.id)
                        .attr('height', '100%')
                        .attr('width', '100%')
                        .attr('patternContentUnits', 'objectBoundingBox')
                        .append('image')
                        .attr('href', 'tiktok.png')
                        .attr('width', 1)
                        .attr('height', 1)
                        .attr('preserveAspectRatio', 'none'),
                    update => update,
                    exit => exit.remove()
                );
        }
    
        function updateRectangles(filteredData) {
            console.log("Updating rectangles with data:", filteredData);
            return svg.selectAll(".bubble")
                .data(filteredData, d => d.id)
                .join(
                    enter => {
                        console.log("Entering new elements:", enter.size());
                        return enter.append("rect")
                                    .attr('class', 'bubble')
                                    .attr('width', rectWidth)
                                    .attr('height', rectHeight)
                                    .attr('fill', d => `url(#${d.id})`)
                                    .attr('opacity', 0)
                                    .attr('x', d => Math.random() * width) // Random initial x position
                                    .attr('y', d => Math.random() * height); // Random initial y position
                
                    },
                    update => {
                        console.log("Updating elements:", update.size());
                        return update;
                    }
                );
        }
    
    // Adjust these values to control the compactness of the bubble
    var centerStrength = 0.1;  // Reduced to allow for smoother expansion
    var collideStrength = 0.025; // Increased to maintain separation between elements
    
    // Set up forces
    simulation
        .force('x', d3.forceX(width / 2).strength(centerStrength))
        .force('y', d3.forceY(height / 2).strength(centerStrength))
        .force('collide', d3.forceCollide().radius(() => Math.sqrt((rectWidth/2)**2 + (rectHeight/2)**2) + 1).strength(collideStrength));
    
    function updateVisualization(filteredData) {
        updatePatterns(filteredData);
        const rects = updateRectangles(filteredData);
    
         // Initialize positions for new nodes
         filteredData.forEach(d => {
            if (d.x === undefined || d.y === undefined) {
                d.x = Math.random() * width;
                d.y = Math.random() * height;
            }
        });
    
        // Gradually increase the center force strength
        let currentCenterStrength = 0.01;
        const targetCenterStrength = 0.1;
        const strengthIncrement = (targetCenterStrength - currentCenterStrength) / 30; // 60 fps for 1 second
    
        // Update existing rectangles
        rects.attr('x', d => d.x)
             .attr('y', d => d.y);
    
        // Transition for new rectangles
        rects.transition()
            .duration(500)
            .attr('opacity', 0.7)
    
        // Adjust the simulation to accommodate the growing bubble
        simulation.nodes(filteredData)
            .force('collide', d3.forceCollide().radius(() => Math.sqrt((rectWidth/2)**2 + (rectHeight/2)**2) + 1).strength(collideStrength))
            .force('center', d3.forceCenter(width / 2, height / 2).strength(currentCenterStrength))
            .alpha(1)
            .restart();
    
        // Gradually adjust the center force and cool down the simulation
        let timer = d3.timer((elapsed) => {
            currentCenterStrength = Math.min(currentCenterStrength + strengthIncrement, targetCenterStrength);
            simulation.force('center').strength(currentCenterStrength);
            
            if (elapsed > 1000) { // Stop after 1 second
                timer.stop();
                simulation.alpha(0.1).alphaDecay(0.02); // Cool down simulation
            }
        });
    
        simulation.on('tick', ticked);
    }
    
    function ticked() {
        svg.selectAll(".bubble")
            .attr('x', d => Math.max(0, Math.min(width - rectWidth, d.x - rectWidth / 2)))
            .attr('y', d => Math.max(0, Math.min(height - rectHeight, d.y - rectHeight / 2)));
    }
    
        // Initialize with empty data
        let allData = []; // Store all data
    
        // Set up Scrollama
        const scroller = scrollama();
    
        scroller
            .setup({
                step: '.step',
                offset: 0.5,
                debug: false
            })
            .onStepEnter(response => {
                console.log("Step entered:", response.index, response.direction);
                const step = response.element.dataset.step;
    
                if (step === "0") {
                allData = [];
            } else if (step === "1") {
                allData = data.filter(d => d.gamer.toUpperCase() === 'TRUE');
            } else if (step === "2") {
                allData = data.filter(d => d.gamer.toUpperCase() === 'TRUE' || d.deepfakes.toUpperCase() === 'TRUE');
            } else if (step === "3") {
                allData = data.filter(d => d.gamer.toUpperCase() === 'TRUE' || d.deepfakes.toUpperCase() === 'TRUE' || d.songs.toUpperCase() === 'TRUE');
            } else if (step === "4") {
                allData = [];
            }
            
                
                console.log("Filtered data:", allData.length, "elements");

                updateVisualization(allData);
            });
    
        // Setup resize event
        window.addEventListener('resize', scroller.resize);
    } 
    </script>
</body>
</html>